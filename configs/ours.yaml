# Pretraining params
bg_pretrain:
  # model .ckpt related
  resume_ckpt: # "/home/user/Projects/4DOCC/logs/ours/bg_pretrain/100%nuscenes/vs-0.1_t-9.5_bs-4_epoch-100/version_0/checkpoints/epoch=9.ckpt" # null

  # dataset related
  dataset_name: "nuscenes" # "sekitti", "KITTITRA", "KITTITRA_M", "APOLLO", "nuscenes", "WAYMO_M", "AVIA"
  downsample_level: "sequence"  # "sequence", "sample", "none"
  downsample_pct: 100   # use 10% of training dataset to train the model
  shuffle: False # not used, random sampler default shuffle?
  augmentation: True

  # data processing related
  n_input: 10
  n_skip: 1
  scene_bbox: [ -70.0, -70.0, -4.5, 70.0, 70.0, 4.5 ]  # valid point cloud range
  quant_size: 0.1 # Used for discretization in x,y,z when creating a sparse tensor
  time_interval: 0.5 # sample data time interval, nusc: 0.05, kitti: 0.1; sample time interval: nusc: 0.5
  pos_dim: 4 # x, y, z, t
  feat_dim: 128 # feature dimension of each point
  featmap_size: 1.0  # feature map resolution
  transform: True # If true, the points are pose-aligned before feeding to the model
  ego_mask: True

  # training related
  num_epoch: 100
  batch_size: 4
  acc_batches: 1 # accumulate gradients over k batches before stepping into the optimizer
  lr_start: 0.0001
  lr_epoch: 1
  lr_decay: 0.99
  weight_decay: 0.0001
  bg_cls_weight: [0.1, 0.9] # free: 0.1; occ: 0.9

  # device related
  num_workers: 12
  num_devices: 1 # could be integer of how many cuda devices to use, or a list that specify which devices to use [0, 1, 2, 3]


# Background samples test
bg_test:



# Finetuning params
mos_finetune:
  resume_ckpt: null
  pretrain_model_dir: "ours/bg_pretrain/100%nuscenes/vs-0.1_t-9.5_bs-4_epoch-100/version_0/checkpoints/"
  pretrain_epoch: 99 # finetuned model name: occ4d_100%nuscenes_vs-0.2_t-3.0_bs-1_epoch=14_vs-xx_t-xx_bs-xx
  lr_start: 0.0001
  lr_epoch: 1
  lr_decay: 0.99
  weight_decay: 0.0001
  num_epoch: 50
  batch_size: 6
  acc_batches: 1 # accumulate gradients over k batches before stepping into the optimizer
  num_workers: 12
  num_devices: 1 # could be integer of how many cuda devices to use, or a list that specify which devices to use [0, 1, 2, 3]


# Test: MOS Benchmark
mos_test:
  # 0.  mask_train-100%sekitti_epo-60_finetune-10%nusc_epo-60_bs-4_vs-0.1_ss-10
  # 1.  train-100%sekitti_epo-60_finetune-10%nusc_epo-60_bs-16_vs-0.1_ss-10
  model_dataset: "10%nuscenes"
  model_name: "occ4d_100%nuscenes_vs-0.2_t-1.3_bs-1_epoch=14_vs-0.2_t-1.3_bs-4"
  model_version: "version_0"
  downsample_level: null  # "sequence", "sample", null
  augmentation: False
  num_devices: 1
  batch_size: 4
  num_workers: 1
